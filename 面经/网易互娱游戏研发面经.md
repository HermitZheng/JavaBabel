# 网易互娱游戏研发面经



## 计网

  讲一下TCP协议 ；如何保证可靠性 

  回答了 序列号保证按序到达 ACK保证不丢包 

   

  TCP是怎么最大程度利用带宽的 

  回答了拥塞控制 

 

滑动窗口作用

 

  TCP是怎么判断丢包的? 

  回答了收到三次相同的ACK就判断丢包 

  被追问: 收到三次相同的ACK就代表丢包吗？ 如果5个包 1 2 3 4 5   中途由于路由的原因 导致 收到的顺序是 1 3 4 5 2 这样也会发3次响应号为2的ACK 这样也算是丢包吗 





tcp粘包和分包 问题处理





UDP为了提高可靠性应该加哪些东西？



游戏中使用到的网络协议（UDP）



UDP引起的丢包





如果避免丢包，以及如何判断丢包（接收端接收到的数据包序号不连续）



https的连接建立过程



ARP和DNS的功能与区别



socket通信建立

- 客户端：
  - socket() 建立服务器，connect() 连接服务端（阻塞），接收到第二次握手之后返回
- 服务端：
  - socket() 建立服务器，bind() 绑定本地端口号（监听），listen() 设置连接数（创建一个队列）并监听
  - accept() 准备接受连接请求（阻塞），接收到第三次握手之后返回





## 操作系统

操作系统调度方式



讲一下IO多路复用

如果不用IO多路复用的方式 不也可以吗 为什么要用IO多路复用呢



select和epoll区别



socket api



阻塞和非阻塞



Reactor模型



生产者-消费者



内核态和用户态存在的必要性



进程线程的区别，系统调用是进程还是线程



线程共用一个资源会发生什么



多线程和多进程的优点，用在什么场合



进程，线程的通信方式



线程同步，死锁



一个全局变量，多线程访问实施细节



虚拟内存



cpu多级缓存



操作系统的各种锁及实现



## Java

静态变量，局部变量，全局静态



无锁队列



  原子操作









## 数据结构、算法

红黑树



AVL与[红黑树](https://www.nowcoder.com/jump/super-jump/word?word=红黑树)对比



[二叉树](https://www.nowcoder.com/jump/super-jump/word?word=二叉树)和图的遍历



哈希冲突怎么解决



手撕堆排



大小堆，最差时间复杂度



快排最差时间复杂度



快排如何解决最坏时间复杂度，不能是随机快排



`a[i][j]和a[j][i]`（行优先、列优先的区别）



八皇后问题



面值为1、3、5的硬币，用最少的数量组合出N





13张牌打乱，每张牌概率相同





光线追踪



写个斐波那契数列递归，空间复杂度多少，计算调用f(N)的次数





爬楼梯 2/3个台阶每次



回文子串数量



100万个账号数据 局部匹配

比如 adgjabkff ,abcdef，ryuoojg 中找到包含ab的账号： adgjabkff，abcdef





给定字符串（可以是任何字符），判断括号是否合法



实现stack模板，只实现push功能



[链表](https://www.nowcoder.com/jump/super-jump/word?word=链表)判断是否有环，有的话找出入环节点



设计LRU缓存结构



三维空间直线方程



找[二叉树](https://www.nowcoder.com/jump/super-jump/word?word=二叉树)中两个节点的最近公共祖先



力扣easy题，找字符串不重复字母



带函数表达式的括号匹配；



汉诺塔问题，输入数组表示每个圆盘所处的塔，求这个数组是第几个状态。



爬楼梯每次2或3阶，输出所有组合方案



## 场景

设计一个分布式的图片处理系统  50台机器 怎么设计 使得处理速度最快 

  答了 一致性哈希的方式 把图片交给虚拟节点处理 然后 虚拟节点分配机器 



又追问了 如果机器的算力不同，比如cpu核数不同 如何让它均衡 

  答了由虚拟节点统计算力然后平均分配 



又问了 每个机器的空闲状态是动态变化的 如果由虚拟节点统计 空闲状态 是没有时效性的，而且 计算算力的方式比较复杂 有没有简单的方式  

  回答 了 让每个机器自己根据是否空闲来申请作业 



又问了 如果有的机器 处理图片速度特别快 但是网络通讯的消耗特别大 怎么办 

  回答不上来.. 这个问题就先终止了



二维场景有一堆怪兽，扔个炸弹判断击中哪些（四叉树），怪物移动时间复杂度（nlogn），写一下节点数据结构（四个child指针，坐标x和y，边长l，set保存怪物集合）





一个地图有很多个加油站 一辆车如何快速找到距离最近的加油站 （不会，后来问了大佬说用geohash）

参考路由的方式，构建虚拟节点里面存一个记录邻近加油站距离的结构，类似路由表那样





王者荣耀 释放圆形技能， 判断受到伤害的敌方单位





判断单位在区域内的做法



地图怎么划分区域





敌方单位受到伤害后，每隔两秒掉血，怎么实现？





受到伤害的单位[排序](https://www.nowcoder.com/jump/super-jump/word?word=排序)， [链表](https://www.nowcoder.com/jump/super-jump/word?word=链表)和map插入的复杂度





一名玩家向另一面玩家射击，判断这个过程中[客户端](https://www.nowcoder.com/jump/super-jump/word?word=客户端)和服务端的交互同步，以及网络协议包的变化



服务器有10W+的玩家，如何在排行榜上显示战力前1000的玩家（topK问题，要我口述了下思路，没有写代码）



场景内有10W+怪物，主角释放一个圆形技能怎么判断击中怪物（八叉树碰撞检测）



怎么设计pubg的随机空投点，假如是一个圆形的小岛（圆内均匀随机点）



## 智力题

12个小球，有一个质量与其他不一样（或轻或重），用天平最少称几次能称出（3次）